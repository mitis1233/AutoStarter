## AutoStarter 自動啟動器

一鍵自動化啟動流程：啟動應用程式&設定音訊裝置工具

## 截圖

![介面](https://raw.githubusercontent.com/mitis1233/AutoStarter/refs/heads/main/Picture.png)


## 功能介紹

新增程式：可啟動多個應用程式 可指定啟動參數

啟動最小化： 打勾將會最小化來啟動應用程式

強制最小化：監控連帶開啟的子進程 確保所有相關窗口都被最小化 假如最小化沒效可使用

新增延遲：可插入啟動延遲 可自定義延遲秒數

音訊裝置：可切換、停用 撥放設備及錄製設備

電源計畫：可切換到指定Windows電源計畫

自定義流程： 自訂從上而下的啟動順序 可按鈕&右鍵選單操控

檔案關聯： 首次啟動須點選註冊檔案關聯 關聯後可直接開啟.autostart檔案運行 除非你更換AutoStarter位置才要重新關聯

匯入設定檔： 從以儲存.autostart匯入設定檔 也可以滑鼠拖放.autostart檔案匯入

輸出設定檔： 將您的自動化流程儲存為.autostart設定檔

## 使用說明

首次啟動須點選註冊檔案關聯

1. 設定好自動化啟動流程

2. 點選輸出設定檔按鈕儲存.autostart設定檔

3. 開啟.autostart設定檔即可啟動自定義的自動化啟動流程

## 下載 Download

[獨立式](https://github.com/mitis1233/AutoStarter/releases/latest/download/AutoStarter_win-x64_Full.zip)

[相依 需下載.NET 10 Desktop Runtime](https://github.com/mitis1233/AutoStarter/releases/latest/download/AutoStarter_win-x64.zip)




## ✨ 以下AI詳細介紹

AutoStarter 旨在簡化和自動化一系列電腦操作。使用者可以透過圖形化介面建立一個包含多個步驟的「動作序列」，並將其儲存為一個 `.autostart` 設定檔。執行此設定檔後，AutoStarter 將會依照預設順序自動完成所有指定的任務。

無論是遊戲玩家需要在啟動遊戲前設定特定的音訊裝置和電源計畫，還是專業人士需要一鍵開啟多個工作軟體，AutoStarter 都能提供穩定可靠的自動化解決方案。

## 主要功能

AutoStarter 支援以下幾種核心動作類型，使用者可以自由組合它們以建立複雜的自動化流程：

- **啟動應用程式 (`.exe`)**
  - 指定要執行的應用程式路徑。
  - 可設定啟動參數 (Arguments)。
  - 提供「最小化」和「強制最小化」選項，確保應用程式在背景啟動。

- **設定延遲**
  - 在動作序列中插入等待時間，單位為秒。
  - 用於等待某個程式完全載入後再執行下一步操作。

- **設定音訊裝置**
  - 自動切換預設的播放或錄音裝置。
  - 透過篩選核取方塊自訂是否顯示「已停用」與「未插入 / 未連接」裝置，預設僅顯示正常裝置，並依狀態排序。
  - 適用於需要在不同場景（如遊戲、會議）中使用不同音訊設備的使用者。

- **停用音訊裝置**
  - 暫時停用指定的音訊裝置。

- **設定電源計畫**
  - 自動切換 Windows 的電源計畫（如「高效能」、「平衡」等）。
  - 適合在執行高效能需求的應用（如遊戲、渲染）前自動切換。

## 特色功能

- **進階視窗最小化**
  - **普通最小化**: 使用標準方式啟動並最小化視窗。
  - **強制最小化**: 採用更強力的監控模式，持續追蹤目標程序及其衍生的子程序，並在視窗出現後反覆嘗試將其最小化，直到成功為止。此功能特別適用於某些忽略標準最小化指令的應用程式。

- **子程序最小化支援**
  - 當啟動器（Launcher）在啟動主程式後立即退出時，AutoStarter 能夠智慧地追蹤並最小化由啟動器創建的子程序視窗，解決了傳統最小化功能在此類情境下的失效問題。

- **檔案關聯與拖放**
  - 提供「註冊檔案關聯」功能，讓使用者可以直接雙擊 `.autostart` 檔案來執行動作序列。
  - 支援將 `.autostart` 檔案直接拖放到主視窗以快速匯入設定。

- **直覺的 UI 操作**
  - 透過簡單的按鈕點擊即可新增、移除、編輯和排序各項動作。
  - 所有設定都儲存在易於閱讀和編輯的 JSON 格式檔案中。

## 使用教學

1. **開啟主程式**: 執行 `AutoStarter.exe`。
2. **建立動作序列**:
   - 點擊「新增應用程式」、「新增延遲」等按鈕，將動作加入到列表中。
   - 在列表中選中某個動作，使用「上移」、「下移」按鈕調整執行順序。
   - 雙擊某個動作或點擊「編輯」按鈕可修改其詳細參數（如檔案路徑、延遲時間等）。
3. **儲存設定檔**:
   - 點擊「儲存設定檔」，將目前的動作序列儲存為一個 `.autostart` 檔案。
4. **註冊檔案關聯 (建議)**:
   - 點擊「工具」選單中的「註冊檔案關聯」，之後便可直接雙擊 `.autostart` 檔案執行。
5. **執行**:
   - 雙擊儲存的 `.autostart` 檔案，AutoStarter 將在背景自動執行所有設定好的動作。

## 技術細節

- **框架**: 使用 .NET WPF (Windows Presentation Foundation) 建構圖形化使用者介面。
- **核心邏輯**: 
  - 透過 `System.Diagnostics.Process` 啟動和管理外部應用程式。
  - 使用 `System.Text.Json` 處理 `.autostart` 設定檔的序列化與反序列化。
- **音訊裝置管理**:
  - 借助 `NAudio` 和 `CoreAudio` COM 介面來列舉和設定系統的預設音訊裝置。
- **電源計畫管理**:
  - 透過 `powercfg.exe` 命令列工具來列舉系統所有可用的電源計畫。
  - 使用 P/Invoke 呼叫 `powrprof.dll` 中的 `PowerSetActiveScheme` Win32 API 來設定作用中的電源計畫。
- **視窗控制與最小化**:
  - 大量使用 P/Invoke 呼叫 `user32.dll` 中的 Win32 API，例如：
    - `EnumWindows` / `IsWindowVisible`: 列舉和過濾可見視窗。
    - `PostMessage` / `ShowWindow`: 傳送 `WM_SYSCOMMAND` 訊息或直接指令來最小化視窗。
    - `SendMessageTimeout`: 檢查視窗是否回應，避免在無回應的視窗上操作導致卡死。
- **子程序追蹤**:
  - 使用 `System.Management` (WMI) 查詢 `Win32_Process`，透過 `ParentProcessId` 屬性來建立程序之間的父子關係，以實現對子程序的追蹤。
  
## 更新說明

> 最新更新：音訊裝置體驗全面升級（2026-01）

- **音訊裝置持久化匹配**
  - 即使驅動更新或硬體 ID 變動，也能透過裝置 InstanceId 與友善名稱自動重新匹配對應的播放/錄音裝置。
  - 在 `.autostart` 設定檔中會同步保存最新的 DeviceId 與 InstanceId，避免裝置更名後無法切換。

- **隱藏音訊裝置篩選器**
  - 新增「顯示已停用」、「顯示未插入 / 未連接」兩個核取方塊，預設只顯示可用裝置。
  - 清單固定按照「正常 → 已停用 → 未插入 → 未連接」排序，快速找出可以啟用的裝置。

- **錯誤防護**
  - 優化 COM 例外處理，當系統無法列舉特定狀態的音訊裝置時，自動降級至安全清單，避免 UI 當機。
  - 在執行 `.autostart` 檔時也會動態解析裝置，確保切換或停用指令不會失敗。

---
